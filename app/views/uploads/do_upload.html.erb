<% content_for(:title, 'Upload Spreadsheet') %>
<% content_for(:page_class, 'uploads') %>

<h1 class='h2'>Upload Spreadsheet</h1>
<h2 class='h4'>Upload Curriculum file for:</h2>
<ul class='titleList'>
  <li>Subject: <%= @upload.subject.code %></li>
  <li>Grade Band: <%= @upload.grade_band.code %></li>
  <li>Language: <%= @upload.locale.name %></li>
</ul>
<!-- h3 class='h6'></h3>
<h3 class='h6'></h3>
<h3 class='h6'></h3 -->
<div class="col-lg-8 offset-lg-2 col-sm-10 offset-sm-1 col-xs-12">
  <div class="progress">
    <div class="progress-bar" role="progressbar" style="width: <%= BaseRec::UPLOAD_PROGRESS_PCT[@upload.status] %>%" aria-valuenow="<%= BaseRec::UPLOAD_PROGRESS_PCT[@upload.status] %>" aria-valuemin="0" aria-valuemax="100"></div>
  </div>
</div>
<h4 class='h4'>Status: <%= BaseRec::UPLOAD_STATUS[@upload.status] %></h4>
<h5 class='h5'>Status Detail: <%= @upload.status_detail %> Uploaded</h4>
<% if @errs.count > 0 %>
  <ul class='statusList'><%= @errs.count %> Errors</h5>
<%
    @errs.each do |msg|
%>
    <li><%= msg %></li>
<%
    end # if
  end # each msg
%>
<div><%= @messages %></div>
<h5 class='h6'><%= @message %></h5>
<%= form_tag do_upload_upload_path, {multipart: true, class: 'text-center'} do |form| %>
  <%= file_field(:upload, :file, accept: 'text/csv', class: 'text-center') %>
  <br>
  <button class='btn btn-primary' type='submit'>Upload</button>
<% end %>

<% if @rptRecs.count > 0 %>
  <table id='uploadReport' class='table table-striped table-bordered'>
    <thead>
      <tr>
        <th><%= BaseRec::UPLOAD_RPT_LABELS[BaseRec::UPLOAD_RPT_AREA] %></th>
        <th><%= BaseRec::UPLOAD_RPT_LABELS[BaseRec::UPLOAD_RPT_COMPONENT] %></th>
        <th><%= BaseRec::UPLOAD_RPT_LABELS[BaseRec::UPLOAD_RPT_OUTCOME] %></th>
        <th><%= BaseRec::UPLOAD_RPT_LABELS[BaseRec::UPLOAD_RPT_INDICATOR] %></th>
        <th><%= BaseRec::UPLOAD_RPT_LABELS[BaseRec::UPLOAD_RPT_CODE] %></th>
        <th><%= BaseRec::UPLOAD_RPT_LABELS[BaseRec::UPLOAD_RPT_DESC] %></th>
        <th><%= BaseRec::UPLOAD_RPT_LABELS[BaseRec::UPLOAD_RPT_MSG] %></th>
      </tr>
    </thead>
    <tbody>
<%
    @rptRecs.each do |rec|
%>
      <tr data-code='<%= rec[4] %>'>
<%
      rec.each_with_index do |col, ix|
%>
        <td class='col<%= BaseRec::UPLOAD_RPT_COL[ix] %>'><%= col.to_s %></td>
<%
      end # col of rec
%>
      </tr>
<%
    end # each rec
%>
    </tbody>
  </table>
<%
  end # if @rptRecs
%>
